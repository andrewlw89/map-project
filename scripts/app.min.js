function MapViewModel(){"use strict";function e(){r=new google.maps.Map(document.getElementById("map-canvas"),{center:p,mapTypeId:google.maps.MapTypeId.HYBRID}),o(),i();var e=document.getElementById("list");r.controls[google.maps.ControlPosition.RIGHT_CENTER].push(e),google.maps.event.addListener(r,"bounds_changed",function(){r.getBounds()});var n=window.setTimeout(t,5e3);google.maps.event.addListener(r,"tilesloaded",function(){window.clearTimeout(n)})}function o(){var e={location:p,radius:1200,types:["restaurant","bar","cafe","food"]};d=new google.maps.InfoWindow,s=new google.maps.places.PlacesService(r),s.nearbySearch(e,function(e,o){if(o==google.maps.places.PlacesServiceStatus.OK){var t=new google.maps.LatLngBounds;e.forEach(function(e){e.marker=a(e),t.extend(new google.maps.LatLng(e.geometry.location.lat(),e.geometry.location.lng()))}),r.fitBounds(t),e.forEach(n)}})}function n(e){var o,n={};n.place_id=e.place_id,n.position=e.geometry.location.toString(),n.name=e.name,void 0!==e.vicinity?o=e.vicinity:void 0!==e.formatted_address&&(o=e.formatted_address),n.address=o,l.allLocations.push(n)}function a(e){var o,n=new google.maps.Marker({map:r,name:e.name.toLowerCase(),position:e.geometry.location,place_id:e.place_id,animation:google.maps.Animation.DROP});void 0!==e.vicinity?o=e.vicinity:void 0!==e.formatted_address&&(o=e.formatted_address);var a='<div style="font-weight: bold">'+e.name+"</div><div>"+o+"</div>"+l.foursquareInfo;return google.maps.event.addListener(n,"click",function(){d.setContent(a),d.open(r,this),r.panTo(n.position)}),g.push(n),n}function t(){$("#map-canvas").html("Whoops, there was an error and it looks like Google Maps didn't load!")}function i(){var e=r.getCenter();c=e.lat(),u=e.lng()}var r,s,d,l=this,c="",u="",p=new google.maps.LatLng(30.311657,-81.691094),g=[];l.allLocations=ko.observableArray(),l.foursquareInfo="",$("#filter").keyup(function(){var e=$(this).val();$(".nav li").each(function(){$(this).text().search(new RegExp(e,"i"))<0?$(this).fadeOut():$(this).show()})}),l.clickMarker=function(e){for(var o,n=0;n<g.length;n++)if(e.place_id===g[n].place_id){o=g[n];break}l.getFoursquareInfo(e),r.panTo(o.position),setTimeout(function(){var n='<div style="font-weight: bold">'+e.name+"</div><div>"+e.address+"</div>"+l.foursquareInfo;d.setContent(n),d.open(r,o)},500)};var f="I3ZHKHFUGCENSSNLNCK0UWXKUXQO4RXSVLC1DE30TBRLKASN",m="GZO1LJTHX23YFLIMFGOLTX1M0GWM21FMH513U2U5N44KC1SZ";this.getFoursquareInfo=function(e){var o="https://api.foursquare.com/v2/venues/search?client_id="+f+"&client_secret="+m+"&v=20150321&ll="+c+","+u+"&query='"+e.name+"'&limit=1";$.getJSON(o).done(function(e){l.foursquareInfo="<p>Foursquare:<br>";var o=e.response.venues[0],n=o.name;l.foursquareInfo+=null!==n&&void 0!==n?"Name: "+n+"<br>":"Name: Not Found";var a=o.contact.formattedPhone;l.foursquareInfo+=null!==a&&void 0!==a?"Phone: "+a+"<br>":"Phone: Not Found";var t=o.contact.twitter;null!==t&&void 0!==t&&(l.foursquareInfo+="twitter: @"+t+"<br>")})},google.maps.event.addDomListener(window,"load",e)}ko.applyBindings(new MapViewModel);